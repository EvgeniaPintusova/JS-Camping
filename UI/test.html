<!DOCTYPE html>
<html>
  <head> </head>
  <body>
    <h1>A Web Page</h1>

    <form id="demo">
      <input type="text" placeholder="Enter Username" name="name" required />
      <input
        type="password"
        placeholder="Enter Password"
        name="pass"
        required
      />
      <button type="button" onclick="registerrr()">Try it</button>
    </form>
    <div
      id="error"
      style="height: 50px; width: 50px; display: none; background-color: red"
    ></div>
  </body>
  <script>
    async function registerrr() {
      try {
        var formdata = new FormData(document.getElementById("demo"));
        // formdata.append("name", document.getElementById("demo").name.value);
        // formdata.append("pass", document.getElementById("demo").pass.value);
        console.log(formdata);
        const response = await fetch(
          "https://jslabdb.datamola.com/auth/register",
          {
            method: "POST",
            headers: {
              Authorization: `Bearer ${localStorage.getItem("token")}`,
            },
            body: formdata,
          }
        ).then((data) => data.json());
        if (response.error) {
          throw new Error(response.error);
        }
        localStorage.setItem("token", response.token);
        return true;
      } catch (e) {
        document.getElementById("error").style.display = "block";
        return false;
      }
    }
  </script>
</html>
